#coding: utf-8
import redis
from mongoclient import fbt
db = fbt
month_fb = [
["滴滴哒",6862,13394],
["Ryan",74549,12720],
["晚风伊人醉",107921,10377],
["小小木",88350,10077],
["旺仔牛奶86866",4543,9399],
["小黑。",161342,9322],
["晓晓游子",49185,8682],
["keiskei",21130,8461],
["bolice888",19051,6686],
["SteveGT",53997,6620],
["小艾",75464,6098],
["ghangzaiqiman",18761,5903],
["逆、光",21294,5061],
["你大爷的",200,4982],
["小楼昨夜又春风",51433,4739],
["kel",4314,4726],
["林煮酒",830,4660],
["xust-ttxy",52014,4654],
["ZSK",116923,4534],
["大逗比",69650,4512],
["牛苹果",40189,4155],
["太阳8",24847,3900],
["时间的脚印",29562,3890],
["清风流云",38778,3723],
["砂青",1775,3614],
["小花花",34917,3563],
["fzzf",1745,3402],
["杀不死的龙傲天",104907,3398],
["混混混昏",565,3392],
["白天不懂夜的黑aa",746,3336],
["思Yu",101233,3251],
["萧炎",16039,3245],
["wuwuwuwuwu",1430,3149],
["雨落了盛夏",10703,3146],
["卧槽卧槽",7823,3093],
["干将",5170,3079],
["筱沫",24891,3075],
["梓笑",85969,2943],
["后青春期的诗",12157,2923],
["yjyz2010",8942,2912],
["Drz",6788,2890],
["Mushroom",3293,2878],
["小土匪",76953,2843],
["大户撒",466,2827],
["Chad",6883,2768],
["竹立",3583,2731],
["爸爸来了",222,2699],
["沧岚无江",43972,2671],
["sdc",730,2661],
["墨小影",28413,2458],
["Mr.M",10266,2449],
["wbyzzz",4356,2433],
["定南",7244,2416],
["BIRD MAN",39507,2387],
["MJZ007",50016,2372],
["笨笨的",609,2339],
["K.Tao说",829,2336],
["awjdkna",620,2258],
["nongfu",990,2230],
["梁山好汉",3425,2224],
["luciferc",2806,2219],
["小Ｚ",69448,2213],
["liliren",2931,2202],
["小乖一抹微笑",1466,2199],
["祥哥",3104,2199],
["Huan-Echo",201,2195],
["天下1314",7050,2185],
["silence嫣然",252,2167],
["jiumi",10135,2145],
["baby fat",200,2128],
["迹夏",4056,2088],
["了星",9983,2077],
["金鞭美少年",5469,2075],
["yuj",42119,2069],
["剑与玫瑰",4534,2049],
["Dream_ge",14975,2036],
["火箭詹皇",10713,2034],
["FoolRabbit",7500,2022],
["捏口一只",209,2002],
["chawuciren",54867,1994],
["彭大大",5767,1989],
["符浩",3354,1986],
["小白兔亚",8222,1983],
["damengge",400877,1977],
["南国书生赵静庵",6584,1965],
["KORSC",1877,1962],
["疯狂奔跑的鸵鸟",64106,1952],
["我喜欢我选择",17050,1943],
["诚琛岑",9976,1927],
["骑着熊猫去旅行",6188,1926],
["Lennonclw",231,1918],
["HJYukie",340,1912],
["喵~",93371,1894],
["南郭",1727,1861],
["martin_",2524,1848],
["longtao",484,1822],
["破纸片子007",686,1814],
["蓝Q风",436,1789],
["来碗内牛满面",3757,1772],
["为爱执着",211,1767],
]
week_fb = [
["滴滴哒",6862,12812],
["Ryan",74549,11848],
["小小木",88350,9331],
["晚风伊人醉",107921,9327],
["旺仔牛奶86866",4543,7919],
["keiskei",21130,7396],
["小黑。",161342,6676],
["晓晓游子",49185,6401],
["小艾",75464,5265],
["bolice888",19051,4898],
["你大爷的",200,4845],
["kel",4314,4726],
["SteveGT",53997,4636],
["林煮酒",830,4582],
["ZSK",116923,4445],
["逆、光",21294,4319],
["ghangzaiqiman",18761,3839],
["小楼昨夜又春风",51433,3753],
["砂青",1775,3586],
["牛苹果",40189,3369],
["白天不懂夜的黑aa",746,3334],
["xust-ttxy",52014,3327],
["大逗比",69650,3174],
["混混混昏",565,3158],
["fzzf",1745,3114],
["小花花",34918,3059],
["时间的脚印",29562,3008],
["太阳8",24847,3000],
["干将",5170,2946],
["大户撒",466,2776],
["萧炎",16039,2727],
["爸爸来了",222,2698],
["wuwuwuwuwu",1430,2655],
["竹立",3583,2614],
["清风流云",38778,2609],
["Drz",6788,2514],
["雨落了盛夏",10703,2508],
["sdc",730,2402],
["思Yu",101233,2340],
["K.Tao说",829,2336],
["awjdkna",620,2252],
["nongfu",990,2230],
["笨笨的",609,2226],
["梁山好汉",3425,2224],
["小乖一抹微笑",1466,2197],
["Huan-Echo",201,2195],
["卧槽卧槽",7823,2195],
["silence嫣然",252,2135],
["baby fat",200,2126],
["沧岚无江",43972,2125],
["后青春期的诗",12157,2091],
["迹夏",4056,2087],
["小土匪",76953,2078],
["筱沫",24891,2052],
["liliren",2932,2026],
["Chad",6883,2005],
["金鞭美少年",5469,1910],
["HJYukie",340,1909],
["小Ｚ",69449,1882],
["BIRD MAN",39507,1851],
["南郭",1727,1848],
["martin_",2524,1842],
["longtao",484,1821],
["yjyz2010",8942,1820],
["火箭詹皇",10713,1811],
["蓝Q风",436,1789],
["定南",7244,1784],
["符浩",3354,1776],
["为爱执着",211,1767],
["喵~",93371,1762],
["杀不死的龙傲天",104907,1733],
["wbyzzz",4356,1719],
["了星",9983,1707],
["骑着熊猫去旅行",6188,1702],
["捏口一只",209,1698],
["好好学丶好好玩",5293,1691],
["彭大大",5767,1682],
["破纸片子007",686,1675],
["ZEH",5842,1650],
["格子君",390,1643],
["狂野翔",736,1641],
["KORSC",1877,1640],
["Dream_ge",14975,1638],
["墨小影",28413,1634],
["Mushroom",3294,1621],
["chawuciren",54867,1602],
["岁月已逝",2227,1575],
["Lennonclw",231,1561],
["碌碌余生",31280,1554],
["只是来看看",428,1550],
["韩曌",5713,1547],
["祥哥",3104,1546],
["yuj",42119,1536],
["bjwl2015",386,1518],
["Mr.M",10266,1509],
["疯狂奔跑的鸵鸟",64106,1506],
["luciferc",2806,1505],
["翔yu",3134,1496],
["钟@@",6120,1480],
["MJZ007",50016,1466],
]
r = redis.StrictRedis(host='192.168.207.72', port=6381, password="123-fbt-all-cache-!@#")
_FB_WEEKLY_CACHE = "fb:cache:weekly"
_FB_MONTHLY_CACHE = "fb:cache:monthly"
keys=[_FB_MONTHLY_CACHE, _FB_WEEKLY_CACHE]
#for m in month_fb:
#    user = m[0]
#    delta_fb = m[2]
#    u = db.users.find_one({"nick_name": user},{"uid":1})
#    if u and "uid" in u:
#      uid = u["uid"]
#      r.hset(keys[0], uid, 0)
#      r.hincrbyfloat(keys[0], uid, delta_fb)
#      print "process ok:"+user
#exit(0)
user = "滴滴"
u = db.users.find_one({"nick_name": user},{"uid":1})
if u and "uid" in u:
    uid = u["uid"]
    r.hset(keys[1], uid, 0)
    r.hset(keys[0], uid, 0)
exit(0)

for m in week_fb:
    user = m[0]
    delta_fb = m[2]
    u = db.users.find_one({"nick_name": user},{"uid":1})
    if u and "uid" in u:
      uid = u["uid"]
      r.hset(keys[1], uid, 0)
      r.hincrbyfloat(keys[1], uid, delta_fb)
      print "process ok:"+user
